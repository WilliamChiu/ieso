{"ast":null,"code":"import { MongoClient } from 'mongodb';\nconst uri = \"mongodb://mongo:27017\";\nconst client = new MongoClient(uri);\nexport default (async (req, res) => {\n  let page = req.body.page;\n  await client.connect();\n  const database = client.db(\"posts\");\n  const collection = database.collection(\"posts\");\n  let posts = await collection.find({}).limit(10).skip(page * 10).toArray();\n  posts = posts.map(post => {\n    if (post.public_private === \"private\") {\n      delete post.username;\n    }\n\n    return post;\n  });\n  req.statusCode = 200;\n  res.json(posts);\n});","map":{"version":3,"sources":["/usr/src/app/pages/api/getPosts.js"],"names":["MongoClient","uri","client","req","res","page","body","connect","database","db","collection","posts","find","limit","skip","toArray","map","post","public_private","username","statusCode","json"],"mappings":"AAAA,SAASA,WAAT,QAA4B,SAA5B;AACA,MAAMC,GAAG,GAAG,uBAAZ;AACA,MAAMC,MAAM,GAAG,IAAIF,WAAJ,CAAgBC,GAAhB,CAAf;AAEA,gBAAe,OAAOE,GAAP,EAAYC,GAAZ,KAAoB;AACjC,MAAIC,IAAI,GAAGF,GAAG,CAACG,IAAJ,CAASD,IAApB;AACA,QAAMH,MAAM,CAACK,OAAP,EAAN;AACA,QAAMC,QAAQ,GAAGN,MAAM,CAACO,EAAP,CAAU,OAAV,CAAjB;AACA,QAAMC,UAAU,GAAGF,QAAQ,CAACE,UAAT,CAAoB,OAApB,CAAnB;AACA,MAAIC,KAAK,GAAG,MAAMD,UAAU,CAACE,IAAX,CAAgB,EAAhB,EAAoBC,KAApB,CAA0B,EAA1B,EAA8BC,IAA9B,CAAmCT,IAAI,GAAG,EAA1C,EAA8CU,OAA9C,EAAlB;AACAJ,EAAAA,KAAK,GAAGA,KAAK,CAACK,GAAN,CAAUC,IAAI,IAAI;AACxB,QAAIA,IAAI,CAACC,cAAL,KAAwB,SAA5B,EAAuC;AACrC,aAAOD,IAAI,CAACE,QAAZ;AACD;;AACD,WAAOF,IAAP;AACD,GALO,CAAR;AAMAd,EAAAA,GAAG,CAACiB,UAAJ,GAAiB,GAAjB;AACAhB,EAAAA,GAAG,CAACiB,IAAJ,CAASV,KAAT;AACD,CAdD","sourcesContent":["import { MongoClient } from 'mongodb'\nconst uri = \"mongodb://mongo:27017\";\nconst client = new MongoClient(uri);\n\nexport default async (req, res) => {\n  let page = req.body.page\n  await client.connect()\n  const database = client.db(\"posts\")\n  const collection = database.collection(\"posts\")\n  let posts = await collection.find({}).limit(10).skip(page * 10).toArray()\n  posts = posts.map(post => {\n    if (post.public_private === \"private\") {\n      delete post.username\n    }\n    return post\n  })\n  req.statusCode = 200\n  res.json(posts)\n}"]},"metadata":{},"sourceType":"module"}